extends layout

block content  
    main 
        p.welcome Hello #{currentUser.first_name}, great to have you here.
        p.instruction Click the button below to buy your favourite cryptocurrency.
        br
        button(class="buy_button") Buy Coin
        .available_coin
            p Available coins
        .currency
            .crypto_card 
                div 
                    img(src="/images/btc.png" alt="Bitcoin")
                div 
                    p Pair: BTC/NGN
                    p Price: NGN 22,328,962.50
            .crypto_card 
                div 
                    img(src="/images/eth.png" alt="Ethereum")
                div 
                    p Pair: ETH/NGN
                    p Price: NGN 1,364,632.50
        .section
            h2.title Pending transactions
            if pending.length === 0
                p No pending transaction
            else
                #table_container
                    table
                        thead
                            tr
                                th S/N
                                th Coin
                                th Amount
                                th Status
                                th Screenshot
                        tbody
                            each transaction, index in pending
                                tr
                                    td #{index + 1}
                                    td #{transaction.crypto}
                                    td #{transaction.amount}
                                    td= transaction.status
                                    td #[a(href=`/user/${transaction._id}/details`) View Details]

        .section
            h2.title Completed transactions
            if completed.length === 0
                p No completed transaction yet.
            else
                table
                    thead
                        tr
                            th S/N
                            th Coin
                            th Amount
                            th Status
                            th Screenshot
                    tbody
                        each transaction, index in completed
                            tr
                                td #{index + 1}
                                td #{transaction.crypto}
                                td #{transaction.amount}
                                td= transaction.status
                                td #[a(href=`/user/${transaction._id}/details`) View Details]

    .buy_form_container
        form(
            class="buy_form"
            action="", method='post' 
            enctype="multipart/form-data"
        )
            div
                label(for='crypto') Select a coin:
                select(
                    name="crypto"
                    value=(underfined===transaction ? "" : `${transaction.crypto}`)
                )
                    option(value="ETH") ETH
                    option(value="BTC" selected) BTC

            div
                label(for='amount') Amount:
                input(
                    required
                    name='amount'
                    type='number' 
                    value=(underfined===transaction ? "" : `${transaction.amount}`)
                )

            div
                label(for='walletAddress') Wallet Address:
                input(
                    required
                    type='text'
                    name='walletAddress'
                    value=(underfined===transaction ? "" : `${transaction.walletAddress}`)
                )

            div
                label(for='paymentScreenshot') Payment Screenshot:
                input(
                    required
                    type='file'
                    accept="image/*"
                    name='paymentScreenshot'
                )

            if error 
                ul 
                    for err in error 
                        li #{err.msg}

            button(type='submit') Submit

    script(type="text/javascript" src="/typescript/user.js")